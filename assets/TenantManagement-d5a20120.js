import{S as B,r as G,h as v,m as O,i as x,j as K,a as d,o as P,c as E,d as s,k as i,b as l,F as M,t as T,w as $}from"./index-e6eb36cf.js";import{T as q}from"./toast-754f1d1d.js";import{f as F}from"./index-2c23f115.js";const X={class:"flex flex-column gap-3"},Q={class:"flex flex-column gap-2"},z=l("span",null,"Tên người thuê:",-1),H={class:"flex flex-column gap-2"},J=l("span",null,"Ảnh người thuê (đường dẫn ảnh):",-1),W={class:"flex flex-column gap-2"},Y=l("span",null,"Số điện thoại:",-1),Z={class:"flex flex-column gap-2"},ee=l("span",null,"Địa chỉ người thuê phòng:",-1),ne={class:"flex flex-column gap-2"},oe=l("span",null,"Phòng thuê:",-1),te={class:"p-error"},le={class:"flex flex-column gap-2"},se=l("span",null,"Ngày thuê:",-1),ae={class:"flex flex-column gap-3"},ie=l("span",{class:"font-bold text-2xl"},"Quản lý người thuê trọ",-1),re={class:"flex justify-content-between"},de={class:"flex gap-2"},ue={class:"p-input-icon-right"},me=["src"],pe={class:"fixed-text"},ce=l("div",{class:"flex justify-content-center"}," Không tìm thấy kết quả nào ",-1),_e={__name:"TenantManagement",setup(fe){const f=q(),{onActionAddInfoTenant:I,onActionUpdateInfoTenant:V,onActionGetTenant:h,onActionGetDetailTenant:y,onActionRemoveTenant:C,onGetterTenant:u,onGetterDetailTenant:g,onGetterRooms:_}=B(),e=G({formInfoTenant:{name:"",image:"",phoneNumber:null,address:"",rentedRoom:"",rentedDate:""},selectedRoom:[],display:!1,popupDetail:{title:"Thêm thông tin người thuê trọ"}}),m=v(""),p=v([]),R=O(()=>_.value.map(({name:t})=>({name:t}))),D=()=>{var t;return F((t=_.value.find(({name:n})=>n===e.formInfoTenant.rentedRoom))==null?void 0:t.price)},b=t=>{var n;e.display=!0,t==="create"?(e.popupDetail.title="Thêm thông tin người thuê trọ",e.formInfoTenant={name:"",image:"",phoneNumber:null,address:"",rentedRoom:""}):(e.popupDetail.title="Sửa thông tin người thuê trọ",y((n=t==null?void 0:t.data)==null?void 0:n.id))},k=async()=>{e.popupDetail.title==="Thêm thông tin người thuê trọ"?await I(e.formInfoTenant):await V(e.formInfoTenant),f.success("Lưu dữ liệu phòng thành công!"),e.display=!1,h()},N=async()=>{for(const t of e.selectedRoom)await C(t.id);f.success("Xóa phòng thành công!"),h()},S=({value:t})=>{u.value.some(({rentedRoom:a})=>a===t)&&(f.warn(`${t} đã có người thuê!`),e.formInfoTenant.rentedRoom=null)},U=()=>{let t=!1;return Object.keys(e.formInfoTenant).forEach(n=>{e.formInfoTenant[n]||(t=!0)}),Object.keys(g.value).forEach(n=>{g.value[n]||(t=!0)}),t},w=()=>{m.value?p.value=u.value.filter(t=>t==null?void 0:t.name.toLowerCase().includes(m.value.toLowerCase())):p.value=u.value};return x(g,t=>{e.formInfoTenant=t}),x(u,t=>{p.value=t}),K(()=>{h()}),(t,n)=>{const a=d("InputText"),A=d("Dropdown"),c=d("Button"),L=d("Dialog"),r=d("Column"),j=d("DataTable");return P(),E(M,null,[s(L,{visible:e.display,"onUpdate:visible":n[7]||(n[7]=o=>e.display=o),modal:"",header:e.popupDetail.title,class:"w-30rem"},{footer:i(()=>[s(c,{label:"Bỏ qua",onClick:n[6]||(n[6]=o=>e.display=!1),class:"p-button-outlined"}),s(c,{label:"Lưu",onClick:k,disabled:U(),autofocus:""},null,8,["disabled"])]),default:i(()=>[l("div",X,[l("label",Q,[z,s(a,{modelValue:e.formInfoTenant.name,"onUpdate:modelValue":n[0]||(n[0]=o=>e.formInfoTenant.name=o)},null,8,["modelValue"])]),l("label",H,[J,s(a,{modelValue:e.formInfoTenant.image,"onUpdate:modelValue":n[1]||(n[1]=o=>e.formInfoTenant.image=o)},null,8,["modelValue"])]),l("label",W,[Y,s(a,{modelValue:e.formInfoTenant.phoneNumber,"onUpdate:modelValue":n[2]||(n[2]=o=>e.formInfoTenant.phoneNumber=o)},null,8,["modelValue"])]),l("label",Z,[ee,s(a,{modelValue:e.formInfoTenant.address,"onUpdate:modelValue":n[3]||(n[3]=o=>e.formInfoTenant.address=o)},null,8,["modelValue"])]),l("label",ne,[oe,s(A,{modelValue:e.formInfoTenant.rentedRoom,"onUpdate:modelValue":n[4]||(n[4]=o=>e.formInfoTenant.rentedRoom=o),options:R.value,optionLabel:"name",optionValue:"name",placeholder:"Chọn phòng thuê",onChange:S},null,8,["modelValue","options"])]),l("label",null,[l("span",te,"Giá phòng: "+T(D()),1)]),l("label",le,[se,s(a,{modelValue:e.formInfoTenant.rentedDate,"onUpdate:modelValue":n[5]||(n[5]=o=>e.formInfoTenant.rentedDate=o),placeholder:"Ví dụ: 01/01/2023 (lưu ý viết đúng định dạng)"},null,8,["modelValue"])])])]),_:1},8,["visible","header"]),l("div",ae,[ie,s(j,{value:p.value,selection:e.selectedRoom,"onUpdate:selection":n[10]||(n[10]=o=>e.selectedRoom=o),tableStyle:"min-width: 40rem",onRowDblclick:n[11]||(n[11]=o=>b(o))},{header:i(()=>[l("div",re,[l("div",de,[s(c,{label:"Thêm người",onClick:n[8]||(n[8]=o=>b("create"))}),s(c,{label:"Xóa phòng",class:"p-button-danger",onClick:N,disabled:!(e!=null&&e.selectedRoom[0])},null,8,["disabled"])]),l("div",null,[l("span",ue,[l("i",{class:"pi pi-search",onClick:w}),s(a,{modelValue:m.value,"onUpdate:modelValue":n[9]||(n[9]=o=>m.value=o),placeholder:"Tìm theo tên người thuê",onKeypress:$(w,["enter"])},null,8,["modelValue","onKeypress"])])])])]),empty:i(()=>[ce]),default:i(()=>[s(r,{selectionMode:"multiple",headerStyle:"width: 3rem"}),s(r,{field:"name",header:"Tên người thuê",headerClass:"white-space-nowrap",class:"w-10rem"}),s(r,{field:"image",header:"Ảnh người thuê",headerClass:"white-space-nowrap",class:"w-10rem"},{body:i(({data:o})=>[l("img",{class:"w-7rem h-5rem object-fit-cover",src:o==null?void 0:o.image,alt:"Lỗi ảnh"},null,8,me)]),_:1}),s(r,{field:"phoneNumber",header:"Số điện thoại",headerClass:"white-space-nowrap",class:"w-10rem"},{body:i(({data:o})=>[l("span",null,T(o==null?void 0:o.phoneNumber),1)]),_:1}),s(r,{field:"address",header:"Địa chỉ người thuê",headerClass:"white-space-nowrap",class:"w-15rem"},{body:i(({data:o})=>[l("span",pe,T(o==null?void 0:o.address),1)]),_:1}),s(r,{field:"rentedRoom",header:"Phòng thuê",headerClass:"white-space-nowrap",class:"w-10rem"}),s(r,{field:"rentedDate",header:"Ngày thuê",headerClass:"white-space-nowrap",class:"w-10rem"})]),_:1},8,["value","selection"])])],64)}}};export{_e as default};
