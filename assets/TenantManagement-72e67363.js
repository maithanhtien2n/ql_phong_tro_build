import{S as A,r as N,h,i as U,a as r,o as B,c as G,d as s,j as a,b as t,k as O,F as j,t as g}from"./index-29c451c3.js";import{T as L}from"./toast-a65cc0ad.js";const M={class:"flex flex-column gap-3"},$={class:"flex flex-column gap-2"},q=t("span",null,"Tên người thuê:",-1),E={class:"flex flex-column gap-2"},F=t("span",null,"Ảnh người thuê (đường dẫn ảnh):",-1),P={class:"flex flex-column gap-2"},X=t("span",null,"Số điện thoại:",-1),K={class:"flex flex-column gap-2"},Q=t("span",null,"Địa chỉ người thuê phòng:",-1),z={class:"flex flex-column gap-2"},H=t("span",null,"Phòng thuê:",-1),J={class:"flex flex-column gap-3"},W=t("span",{class:"font-bold text-2xl"},"Quản lý người thuê trọ",-1),Y={class:"flex gap-2"},Z=["src"],ee={class:"fixed-text"},ne=t("div",{class:"flex justify-content-center"}," Không tìm thấy kết quả nào ",-1),se={__name:"TenantManagement",setup(oe){const p=L(),{onActionAddInfoTenant:T,onActionUpdateInfoTenant:_,onActionGetTenant:u,onActionGetDetailTenant:b,onActionRemoveTenant:w,onActionGetRooms:x,onGetterTenant:c,onGetterDetailTenant:I,onGetterRooms:C}=A(),e=N({formInfoTenant:{name:"",image:"",phoneNumber:null,address:"",rentedRoom:""},selectedRoom:[],display:!1,popupDetail:{title:"Thêm thông tin người thuê trọ"},roomsOption:[]}),f=l=>{var o;e.display=!0,l==="create"?(e.popupDetail.title="Thêm thông tin người thuê trọ",e.formInfoTenant={name:"",image:"",phoneNumber:null,address:"",rentedRoom:""}):(e.popupDetail.title="Sửa thông tin người thuê trọ",b((o=l==null?void 0:l.data)==null?void 0:o.id))},R=async()=>{e.popupDetail.title==="Thêm thông tin người thuê trọ"?await T(e.formInfoTenant):await _(e.formInfoTenant),p.success("Lưu dữ liệu phòng thành công!"),e.display=!1,u()},y=async()=>{for(const l of e.selectedRoom)await w(l.id);p.success("Xóa phòng thành công!"),u()},V=({value:l})=>{c.value.some(({rentedRoom:i})=>i===l)&&(p.warn(`${l} đã có người thuê!`),e.formInfoTenant.rentedRoom=null)},D=()=>{let l=!1;return Object.keys(e.formInfoTenant).forEach(o=>{e.formInfoTenant[o]||(l=!0)}),l};return h(I,l=>{e.formInfoTenant=l}),h(C,l=>{e.roomsOption=l.map(({name:o})=>({name:o}))}),U(()=>{u(),x()}),(l,o)=>{const i=r("InputText"),k=r("Dropdown"),d=r("Button"),v=r("Dialog"),m=r("Column"),S=r("DataTable");return B(),G(j,null,[s(v,{visible:e.display,"onUpdate:visible":o[6]||(o[6]=n=>e.display=n),modal:"",header:e.popupDetail.title,class:"w-30rem"},{footer:a(()=>[s(d,{label:"Bỏ qua",onClick:o[5]||(o[5]=n=>e.display=!1),class:"p-button-outlined"}),s(d,{label:"Lưu",onClick:R,disabled:D(),autofocus:""},null,8,["disabled"])]),default:a(()=>[t("div",M,[t("label",$,[q,s(i,{modelValue:e.formInfoTenant.name,"onUpdate:modelValue":o[0]||(o[0]=n=>e.formInfoTenant.name=n)},null,8,["modelValue"])]),t("label",E,[F,s(i,{modelValue:e.formInfoTenant.image,"onUpdate:modelValue":o[1]||(o[1]=n=>e.formInfoTenant.image=n)},null,8,["modelValue"])]),t("label",P,[X,s(i,{modelValue:e.formInfoTenant.phoneNumber,"onUpdate:modelValue":o[2]||(o[2]=n=>e.formInfoTenant.phoneNumber=n)},null,8,["modelValue"])]),t("label",K,[Q,s(i,{modelValue:e.formInfoTenant.address,"onUpdate:modelValue":o[3]||(o[3]=n=>e.formInfoTenant.address=n)},null,8,["modelValue"])]),t("label",z,[H,s(k,{modelValue:e.formInfoTenant.rentedRoom,"onUpdate:modelValue":o[4]||(o[4]=n=>e.formInfoTenant.rentedRoom=n),options:e.roomsOption,optionLabel:"name",optionValue:"name",placeholder:"Chọn phòng thuê",onChange:V},null,8,["modelValue","options"])])])]),_:1},8,["visible","header"]),t("div",J,[W,s(S,{value:O(c),selection:e.selectedRoom,"onUpdate:selection":o[8]||(o[8]=n=>e.selectedRoom=n),tableStyle:"min-width: 50rem",onRowDblclick:o[9]||(o[9]=n=>f(n))},{header:a(()=>[t("div",Y,[s(d,{label:"Thêm phòng",onClick:o[7]||(o[7]=n=>f("create"))}),s(d,{label:"Xóa phòng",class:"p-button-danger",onClick:y,disabled:!(e!=null&&e.selectedRoom[0])},null,8,["disabled"])])]),empty:a(()=>[ne]),default:a(()=>[s(m,{selectionMode:"multiple",headerStyle:"width: 3rem"}),s(m,{field:"name",header:"Tên người thuê",headerClass:"white-space-nowrap",class:"w-10rem"}),s(m,{field:"image",header:"Ảnh người thuê",headerClass:"white-space-nowrap",class:"w-10rem"},{body:a(({data:n})=>[t("img",{class:"w-7rem h-5rem object-fit-cover",src:n==null?void 0:n.image,alt:"Lỗi ảnh"},null,8,Z)]),_:1}),s(m,{field:"phoneNumber",header:"Số điện thoại",headerClass:"white-space-nowrap",class:"w-10rem"},{body:a(({data:n})=>[t("span",null,g(n==null?void 0:n.phoneNumber),1)]),_:1}),s(m,{field:"address",header:"Địa chỉ người thuê",headerClass:"white-space-nowrap",class:"w-15rem"},{body:a(({data:n})=>[t("span",ee,g(n==null?void 0:n.address),1)]),_:1}),s(m,{field:"rentedRoom",header:"Tên phòng thuê",headerClass:"white-space-nowrap",class:"w-10rem"})]),_:1},8,["value","selection"])])],64)}}};export{se as default};
