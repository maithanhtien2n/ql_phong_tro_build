import{S as A,r as j,h as B,l as G,i as L,a as d,o as O,c as K,d as s,j as i,b as t,k as P,F as E,t as h,w as $}from"./index-3538aa82.js";import{T as q}from"./toast-7685baea.js";import{f as F}from"./index-2c23f115.js";const M={class:"flex flex-column gap-3"},X={class:"flex flex-column gap-2"},Q=t("span",null,"Tên người thuê:",-1),z={class:"flex flex-column gap-2"},H=t("span",null,"Ảnh người thuê (đường dẫn ảnh):",-1),J={class:"flex flex-column gap-2"},W=t("span",null,"Số điện thoại:",-1),Y={class:"flex flex-column gap-2"},Z=t("span",null,"Địa chỉ người thuê phòng:",-1),ee={class:"flex flex-column gap-2"},ne=t("span",null,"Phòng thuê:",-1),oe={class:"p-error"},te={class:"flex flex-column gap-2"},le=t("span",null,"Ngày thuê:",-1),se={class:"flex flex-column gap-3"},ae=t("span",{class:"font-bold text-2xl"},"Quản lý người thuê trọ",-1),ie={class:"flex justify-content-between"},re={class:"flex gap-2"},de={class:"p-input-icon-right"},me=["src"],ue={class:"fixed-text"},pe=t("div",{class:"flex justify-content-center"}," Không tìm thấy kết quả nào ",-1),Te={__name:"TenantManagement",setup(ce){const c=q(),{onActionAddInfoTenant:w,onActionUpdateInfoTenant:x,onActionGetTenant:g,onActionGetDetailTenant:v,onActionRemoveTenant:I,onGetterTenant:m,onGetterDetailTenant:f,onGetterRooms:T}=A(),e=j({formInfoTenant:{name:"",image:"",phoneNumber:null,address:"",rentedRoom:"",rentedDate:""},selectedRoom:[],display:!1,popupDetail:{title:"Thêm thông tin người thuê trọ"}}),u=B(""),V=G(()=>T.value.map(({name:l})=>({name:l}))),y=()=>{var l;return F((l=T.value.find(({name:n})=>n===e.formInfoTenant.rentedRoom))==null?void 0:l.price)},_=l=>{var n;e.display=!0,l==="create"?(e.popupDetail.title="Thêm thông tin người thuê trọ",e.formInfoTenant={name:"",image:"",phoneNumber:null,address:"",rentedRoom:""}):(e.popupDetail.title="Sửa thông tin người thuê trọ",v((n=l==null?void 0:l.data)==null?void 0:n.id))},C=async()=>{e.popupDetail.title==="Thêm thông tin người thuê trọ"?await w(e.formInfoTenant):await x(e.formInfoTenant),c.success("Lưu dữ liệu phòng thành công!"),e.display=!1,g()},R=async()=>{for(const l of e.selectedRoom)await I(l.id);c.success("Xóa phòng thành công!"),g()},D=({value:l})=>{m.value.some(({rentedRoom:a})=>a===l)&&(c.warn(`${l} đã có người thuê!`),e.formInfoTenant.rentedRoom=null)},k=()=>{let l=!1;return Object.keys(e.formInfoTenant).forEach(n=>{e.formInfoTenant[n]||(l=!0)}),Object.keys(f.value).forEach(n=>{f.value[n]||(l=!0)}),l},b=()=>{u.value&&(m.value=m.value.filter(l=>(l==null?void 0:l.name.toLowerCase())===u.value.toLowerCase()))};return L(f,l=>{e.formInfoTenant=l}),(l,n)=>{const a=d("InputText"),N=d("Dropdown"),p=d("Button"),S=d("Dialog"),r=d("Column"),U=d("DataTable");return O(),K(E,null,[s(S,{visible:e.display,"onUpdate:visible":n[7]||(n[7]=o=>e.display=o),modal:"",header:e.popupDetail.title,class:"w-30rem"},{footer:i(()=>[s(p,{label:"Bỏ qua",onClick:n[6]||(n[6]=o=>e.display=!1),class:"p-button-outlined"}),s(p,{label:"Lưu",onClick:C,disabled:k(),autofocus:""},null,8,["disabled"])]),default:i(()=>[t("div",M,[t("label",X,[Q,s(a,{modelValue:e.formInfoTenant.name,"onUpdate:modelValue":n[0]||(n[0]=o=>e.formInfoTenant.name=o)},null,8,["modelValue"])]),t("label",z,[H,s(a,{modelValue:e.formInfoTenant.image,"onUpdate:modelValue":n[1]||(n[1]=o=>e.formInfoTenant.image=o)},null,8,["modelValue"])]),t("label",J,[W,s(a,{modelValue:e.formInfoTenant.phoneNumber,"onUpdate:modelValue":n[2]||(n[2]=o=>e.formInfoTenant.phoneNumber=o)},null,8,["modelValue"])]),t("label",Y,[Z,s(a,{modelValue:e.formInfoTenant.address,"onUpdate:modelValue":n[3]||(n[3]=o=>e.formInfoTenant.address=o)},null,8,["modelValue"])]),t("label",ee,[ne,s(N,{modelValue:e.formInfoTenant.rentedRoom,"onUpdate:modelValue":n[4]||(n[4]=o=>e.formInfoTenant.rentedRoom=o),options:V.value,optionLabel:"name",optionValue:"name",placeholder:"Chọn phòng thuê",onChange:D},null,8,["modelValue","options"])]),t("label",null,[t("span",oe,"Giá phòng: "+h(y()),1)]),t("label",te,[le,s(a,{modelValue:e.formInfoTenant.rentedDate,"onUpdate:modelValue":n[5]||(n[5]=o=>e.formInfoTenant.rentedDate=o),placeholder:"Ví dụ: 01/01/2023 (lưu ý viết đúng định dạng)"},null,8,["modelValue"])])])]),_:1},8,["visible","header"]),t("div",se,[ae,s(U,{value:P(m),selection:e.selectedRoom,"onUpdate:selection":n[10]||(n[10]=o=>e.selectedRoom=o),tableStyle:"min-width: 40rem",onRowDblclick:n[11]||(n[11]=o=>_(o))},{header:i(()=>[t("div",ie,[t("div",re,[s(p,{label:"Thêm phòng",onClick:n[8]||(n[8]=o=>_("create"))}),s(p,{label:"Xóa phòng",class:"p-button-danger",onClick:R,disabled:!(e!=null&&e.selectedRoom[0])},null,8,["disabled"])]),t("div",null,[t("span",de,[t("i",{class:"pi pi-search",onClick:b}),s(a,{modelValue:u.value,"onUpdate:modelValue":n[9]||(n[9]=o=>u.value=o),placeholder:"Tìm theo tên người thuê",onKeypress:$(b,["enter"])},null,8,["modelValue","onKeypress"])])])])]),empty:i(()=>[pe]),default:i(()=>[s(r,{selectionMode:"multiple",headerStyle:"width: 3rem"}),s(r,{field:"name",header:"Tên người thuê",headerClass:"white-space-nowrap",class:"w-10rem"}),s(r,{field:"image",header:"Ảnh người thuê",headerClass:"white-space-nowrap",class:"w-10rem"},{body:i(({data:o})=>[t("img",{class:"w-7rem h-5rem object-fit-cover",src:o==null?void 0:o.image,alt:"Lỗi ảnh"},null,8,me)]),_:1}),s(r,{field:"phoneNumber",header:"Số điện thoại",headerClass:"white-space-nowrap",class:"w-10rem"},{body:i(({data:o})=>[t("span",null,h(o==null?void 0:o.phoneNumber),1)]),_:1}),s(r,{field:"address",header:"Địa chỉ người thuê",headerClass:"white-space-nowrap",class:"w-15rem"},{body:i(({data:o})=>[t("span",ue,h(o==null?void 0:o.address),1)]),_:1}),s(r,{field:"rentedRoom",header:"Phòng thuê",headerClass:"white-space-nowrap",class:"w-10rem"}),s(r,{field:"rentedDate",header:"Ngày thuê",headerClass:"white-space-nowrap",class:"w-10rem"})]),_:1},8,["value","selection"])])],64)}}};export{Te as default};
