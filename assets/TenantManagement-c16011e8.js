import{S as U,r as A,h as j,l as B,i as L,a as d,o as G,c as O,d as s,j as i,b as t,k as K,F as E,w as P,t as _}from"./index-d6915b6a.js";import{T as $}from"./toast-d50bdcfc.js";const q={class:"flex flex-column gap-3"},F={class:"flex flex-column gap-2"},M=t("span",null,"Tên người thuê:",-1),X={class:"flex flex-column gap-2"},Q=t("span",null,"Ảnh người thuê (đường dẫn ảnh):",-1),z={class:"flex flex-column gap-2"},H=t("span",null,"Số điện thoại:",-1),J={class:"flex flex-column gap-2"},W=t("span",null,"Địa chỉ người thuê phòng:",-1),Y={class:"flex flex-column gap-2"},Z=t("span",null,"Phòng thuê:",-1),ee={class:"flex flex-column gap-2"},ne=t("span",null,"Ngày thuê:",-1),oe={class:"flex flex-column gap-3"},te=t("span",{class:"font-bold text-2xl"},"Quản lý người thuê trọ",-1),le={class:"flex justify-content-between"},se={class:"flex gap-2"},ae={class:"p-input-icon-right"},ie=["src"],re={class:"fixed-text"},de=t("div",{class:"flex justify-content-center"}," Không tìm thấy kết quả nào ",-1),ce={__name:"TenantManagement",setup(ue){const c=$(),{onActionAddInfoTenant:b,onActionUpdateInfoTenant:w,onActionGetTenant:h,onActionGetDetailTenant:x,onActionRemoveTenant:v,onGetterTenant:u,onGetterDetailTenant:f,onGetterRooms:y}=U(),e=A({formInfoTenant:{name:"",image:"",phoneNumber:null,address:"",rentedRoom:"",rentedDate:""},selectedRoom:[],display:!1,popupDetail:{title:"Thêm thông tin người thuê trọ"}}),m=j(""),I=B(()=>y.value.map(({name:l})=>({name:l}))),g=l=>{var o;e.display=!0,l==="create"?(e.popupDetail.title="Thêm thông tin người thuê trọ",e.formInfoTenant={name:"",image:"",phoneNumber:null,address:"",rentedRoom:""}):(e.popupDetail.title="Sửa thông tin người thuê trọ",x((o=l==null?void 0:l.data)==null?void 0:o.id))},V=async()=>{e.popupDetail.title==="Thêm thông tin người thuê trọ"?await b(e.formInfoTenant):await w(e.formInfoTenant),c.success("Lưu dữ liệu phòng thành công!"),e.display=!1,h()},C=async()=>{for(const l of e.selectedRoom)await v(l.id);c.success("Xóa phòng thành công!"),h()},D=({value:l})=>{u.value.some(({rentedRoom:a})=>a===l)&&(c.warn(`${l} đã có người thuê!`),e.formInfoTenant.rentedRoom=null)},R=()=>{let l=!1;return Object.keys(e.formInfoTenant).forEach(o=>{e.formInfoTenant[o]||(l=!0)}),Object.keys(f.value).forEach(o=>{f.value[o]||(l=!0)}),l},T=()=>{m.value&&(u.value=u.value.filter(l=>(l==null?void 0:l.name.toLowerCase())===m.value.toLowerCase()))};return L(f,l=>{e.formInfoTenant=l}),(l,o)=>{const a=d("InputText"),k=d("Dropdown"),p=d("Button"),S=d("Dialog"),r=d("Column"),N=d("DataTable");return G(),O(E,null,[s(S,{visible:e.display,"onUpdate:visible":o[7]||(o[7]=n=>e.display=n),modal:"",header:e.popupDetail.title,class:"w-30rem"},{footer:i(()=>[s(p,{label:"Bỏ qua",onClick:o[6]||(o[6]=n=>e.display=!1),class:"p-button-outlined"}),s(p,{label:"Lưu",onClick:V,disabled:R(),autofocus:""},null,8,["disabled"])]),default:i(()=>[t("div",q,[t("label",F,[M,s(a,{modelValue:e.formInfoTenant.name,"onUpdate:modelValue":o[0]||(o[0]=n=>e.formInfoTenant.name=n)},null,8,["modelValue"])]),t("label",X,[Q,s(a,{modelValue:e.formInfoTenant.image,"onUpdate:modelValue":o[1]||(o[1]=n=>e.formInfoTenant.image=n)},null,8,["modelValue"])]),t("label",z,[H,s(a,{modelValue:e.formInfoTenant.phoneNumber,"onUpdate:modelValue":o[2]||(o[2]=n=>e.formInfoTenant.phoneNumber=n)},null,8,["modelValue"])]),t("label",J,[W,s(a,{modelValue:e.formInfoTenant.address,"onUpdate:modelValue":o[3]||(o[3]=n=>e.formInfoTenant.address=n)},null,8,["modelValue"])]),t("label",Y,[Z,s(k,{modelValue:e.formInfoTenant.rentedRoom,"onUpdate:modelValue":o[4]||(o[4]=n=>e.formInfoTenant.rentedRoom=n),options:I.value,optionLabel:"name",optionValue:"name",placeholder:"Chọn phòng thuê",onChange:D},null,8,["modelValue","options"])]),t("label",ee,[ne,s(a,{modelValue:e.formInfoTenant.rentedDate,"onUpdate:modelValue":o[5]||(o[5]=n=>e.formInfoTenant.rentedDate=n),placeholder:"Ví dụ: 01/01/2023 (lưu ý viết đúng định dạng)"},null,8,["modelValue"])])])]),_:1},8,["visible","header"]),t("div",oe,[te,s(N,{value:K(u),selection:e.selectedRoom,"onUpdate:selection":o[10]||(o[10]=n=>e.selectedRoom=n),tableStyle:"min-width: 40rem",onRowDblclick:o[11]||(o[11]=n=>g(n))},{header:i(()=>[t("div",le,[t("div",se,[s(p,{label:"Thêm phòng",onClick:o[8]||(o[8]=n=>g("create"))}),s(p,{label:"Xóa phòng",class:"p-button-danger",onClick:C,disabled:!(e!=null&&e.selectedRoom[0])},null,8,["disabled"])]),t("div",null,[t("span",ae,[t("i",{class:"pi pi-search",onClick:T}),s(a,{modelValue:m.value,"onUpdate:modelValue":o[9]||(o[9]=n=>m.value=n),placeholder:"Tìm theo tên người thuê",onKeypress:P(T,["enter"])},null,8,["modelValue","onKeypress"])])])])]),empty:i(()=>[de]),default:i(()=>[s(r,{selectionMode:"multiple",headerStyle:"width: 3rem"}),s(r,{field:"name",header:"Tên người thuê",headerClass:"white-space-nowrap",class:"w-10rem"}),s(r,{field:"image",header:"Ảnh người thuê",headerClass:"white-space-nowrap",class:"w-10rem"},{body:i(({data:n})=>[t("img",{class:"w-7rem h-5rem object-fit-cover",src:n==null?void 0:n.image,alt:"Lỗi ảnh"},null,8,ie)]),_:1}),s(r,{field:"phoneNumber",header:"Số điện thoại",headerClass:"white-space-nowrap",class:"w-10rem"},{body:i(({data:n})=>[t("span",null,_(n==null?void 0:n.phoneNumber),1)]),_:1}),s(r,{field:"address",header:"Địa chỉ người thuê",headerClass:"white-space-nowrap",class:"w-15rem"},{body:i(({data:n})=>[t("span",re,_(n==null?void 0:n.address),1)]),_:1}),s(r,{field:"rentedRoom",header:"Phòng thuê",headerClass:"white-space-nowrap",class:"w-10rem"}),s(r,{field:"rentedDate",header:"Ngày thuê",headerClass:"white-space-nowrap",class:"w-10rem"})]),_:1},8,["value","selection"])])],64)}}};export{ce as default};
