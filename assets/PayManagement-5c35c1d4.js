import{a as B,f as w}from"./index-2c23f115.js";import{_ as G,S as V,m as N,h as k,a as u,o as i,c as b,d as c,k as l,F as L,p as H,q as j,s as q,b as s,x as D,t as d,l as x,y as z,z as F,A as K}from"./index-e6eb36cf.js";const M=p=>(j("data-v-720c316a"),p=p(),q(),p),U={class:"flex flex-column gap-3"},E=M(()=>s("span",{class:"font-bold text-2xl"}," Danh sách trọ đến hạn thanh toán trong tháy nàng ",-1)),X={key:0,class:"flex flex-column gap-2"},$={class:"flex gap-2"},J=["src"],Q={class:"fixed-text"},W=M(()=>s("div",{class:"flex justify-content-center"}," Không tìm thấy kết quả nào ",-1)),Y={__name:"PayManagement",setup(p){const{onGetterTenant:A,onGetterRooms:_,onActionConfirmPay:P,onActionGetTenant:S}=V(),I=N(()=>[{name:"Tất cả",code:"ALL"},{name:"Chưa thanh toán",code:"CTT"},{name:"Đã thanh toán",code:"DTT"},{name:"Thống kê",code:"TK"}]),g=k(0),y=k([]),m=N(()=>{const o=A.value.filter(e=>{var h;return+((h=e==null?void 0:e.rentedDate)==null?void 0:h.split("/")[0])<=+B(new Date).split(" ")[0]});switch(g.value){case 0:case 3:return o;case 1:return o.filter(e=>+(e==null?void 0:e.status)!=+new Date().getMonth()+1);case 2:return o.filter(e=>+(e==null?void 0:e.status)==+new Date().getMonth()+1)}}),O=async()=>{for(const o of y.value.map(({id:e})=>e))await P(o,`${new Date().getMonth()+1}`);S()},R=o=>{var e;return w((e=_.value.find(({name:h})=>h===o))==null?void 0:e.price)},v=(o,e,h)=>{const a=e.map(t=>{var r;return{...t,price:(r=h.find(({name:T})=>T===(t==null?void 0:t.rentedRoom)))==null?void 0:r.price}});switch(o){case"TONG":return w(a.reduce((t,r)=>t+ +r.price,0));case"DA_THANH_TOAN":return w(a.filter(({status:t})=>+t==+new Date().getMonth()+1).reduce((t,r)=>t+ +r.price,0));case"CON_NO":return w(a.filter(({status:t})=>+t!=+new Date().getMonth()+1).reduce((t,r)=>t+ +r.price,0))}};return(o,e)=>{const h=u("Button"),a=u("Column"),t=u("DataTable"),r=u("TabPanel"),T=u("TabView");return i(),b("div",U,[E,c(T,{activeIndex:g.value,"onUpdate:activeIndex":e[1]||(e[1]=C=>g.value=C)},{default:l(()=>[(i(!0),b(L,null,H(I.value,(C,f)=>(i(),D(r,{key:f,header:C.name},{default:l(()=>[f===3?(i(),b("div",X,[s("span",null,"Tổng doanh thu tháng này: "+d(v("TONG",m.value,x(_))),1),s("span",null,"Đã thanh toán: "+d(v("DA_THANH_TOAN",m.value,x(_))),1),s("span",null,"Còn nợ: "+d(v("CON_NO",m.value,x(_))),1)])):(i(),D(t,{key:1,value:m.value,selection:y.value,"onUpdate:selection":e[0]||(e[0]=n=>y.value=n),tableStyle:"min-width: 40rem"},z({empty:l(()=>[W]),default:l(()=>[f===1?(i(),D(a,{key:0,selectionMode:"multiple",headerStyle:"width: 3rem"})):F("",!0),c(a,{field:"name",header:"Tên người thuê",headerClass:"white-space-nowrap",class:"w-10rem"}),c(a,{field:"image",header:"Ảnh người thuê",headerClass:"white-space-nowrap",class:"w-10rem"},{body:l(({data:n})=>[s("img",{class:"w-7rem h-5rem object-fit-cover",src:n==null?void 0:n.image,alt:"Lỗi ảnh"},null,8,J)]),_:1}),c(a,{field:"phoneNumber",header:"Số điện thoại",headerClass:"white-space-nowrap",class:"w-10rem"},{body:l(({data:n})=>[s("span",null,d(n==null?void 0:n.phoneNumber),1)]),_:1}),c(a,{field:"address",header:"Địa chỉ người thuê",headerClass:"white-space-nowrap",class:"w-15rem"},{body:l(({data:n})=>[s("span",Q,d(n==null?void 0:n.address),1)]),_:1}),c(a,{field:"rentedRoom",header:"Phòng thuê",headerClass:"white-space-nowrap",class:"w-10rem"}),c(a,{field:"rentedRoom",header:"Giá phòng",headerClass:"white-space-nowrap",class:"w-10rem"},{body:l(({data:n})=>[s("span",null,d(R(n.rentedRoom)),1)]),_:1}),c(a,{field:"rentedDate",header:"Ngày thuê",headerClass:"white-space-nowrap",class:"w-10rem"}),c(a,{field:"status",header:"Thanh toán",headerClass:"white-space-nowrap",style:{"min-width":"13rem"}},{body:l(({data:n})=>[s("span",{class:K(["p-2 border-round-2xl",+(n==null?void 0:n.status)==+new Date().getMonth()+1?"opacity-blue":"opacity-red"])},d(+(n==null?void 0:n.status)==+new Date().getMonth()+1?"Đã thanh toán":"Chưa thanh toán"),3)]),_:1})]),_:2},[f===1?{name:"header",fn:l(()=>[s("div",$,[c(h,{label:"Xác nhận thanh toán",onClick:O})])]),key:"0"}:void 0]),1032,["value","selection"]))]),_:2},1032,["header"]))),128))]),_:1},8,["activeIndex"])])}}},ne=G(Y,[["__scopeId","data-v-720c316a"]]);export{ne as default};
